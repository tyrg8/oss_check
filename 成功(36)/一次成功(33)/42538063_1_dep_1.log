tittle:pcre2:pcre2_fuzzer_32_3l: Timeout in pcre2_fuzzer_32_3l
status:Verified
type:Bug
commit_url:https://github.com/PCRE2Project/pcre2/commit/589fea34c87a43d5d6521b3bc3f890f00aaa557b
commit_url_new:https://github.com/PCRE2Project/pcre2/commit/7e0aa46c5d64942e5f1fe4f6cd9d558d98361e74
module:pcre2
target:pcre2_fuzzer_32_3l
have 1 changed files:['jump get_diff!']
==================================================
error running command: python infra/helper.py reproduce pcre2 pcre2_fuzzer_32_3l build/out/pcre2/testcase/testcase_42538063
+ FUZZER=pcre2_fuzzer_32_3l
+ shift
+ '[' '!' -v TESTCASE ']'
+ TESTCASE=/testcase
+ '[' '!' -f /testcase ']'
+ export RUN_FUZZER_MODE=interactive
+ RUN_FUZZER_MODE=interactive
+ export FUZZING_ENGINE=libfuzzer
+ FUZZING_ENGINE=libfuzzer
+ export SKIP_SEED_CORPUS=1
+ SKIP_SEED_CORPUS=1
+ run_fuzzer pcre2_fuzzer_32_3l -runs=100 /testcase
vm.mmap_rnd_bits = 28
/out/pcre2_fuzzer_32_3l -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase < /dev/null
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2602254565
INFO: Loaded 1 modules   (27014 inline 8-bit counters): 27014 [0x624e1df0, 0x624e8776), 
INFO: Loaded 1 PC tables (27014 PCs): 27014 [0x624e8778,0x6251d3a8), 
/out/pcre2_fuzzer_32_3l: Running 1 inputs 100 time(s) each.
Running: /testcase
ALARM: working on the last Unit for 25 seconds
       and the timeout value is 25 (use -timeout=N to change)
==14== ERROR: libFuzzer: timeout after 25 seconds
llvm-symbolizer: [0;1;31merror: [0m'linux-gate.so.1': No such file or directory
    #0 0x62179c72 in __sanitizer_print_stack_trace /src/llvm-project/compiler-rt/lib/asan/asan_stack.cpp:87:3
    #1 0x6207a3f6 in fuzzer::PrintStackTrace() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerUtil.cpp:210:5
    #2 0x6205d9ea in fuzzer::Fuzzer::AlarmCallback() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:304:5
    #3 0x6205d8de in fuzzer::Fuzzer::StaticAlarmCallback() /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:197:6
    #4 0x6207a975 in fuzzer::AlarmHandler(int, siginfo_t*, void*) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerUtilPosix.cpp:33:3
    #5 0xf658d59f  (linux-gate.so.1+0x59f) (BuildId: 53456675cc84cb8f1ac0314875743856cc910c1c)
    #6 0x6207794a in AddValue /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerValueBitMap.h:39:18
    #7 0x6207794a in HandleCmp<unsigned int> /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerTracePC.cpp:391:19
    #8 0x6207794a in __sanitizer_cov_trace_const_cmp4 /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerTracePC.cpp:513:15
    #9 0x6241da34 in _pcre2_xclass_32 /src/pcre2/src/pcre2_xclass.c:104:9
    #10 0x623e02b9 in match /src/pcre2/src/pcre2_match.c:2268:16
    #11 0x623cd228 in pcre2_match_32 /src/pcre2/src/pcre2_match.c:7514:8
    #12 0x621b3d2c in LLVMFuzzerTestOneInput /src/pcre2/src/pcre2_fuzzsupport.c:400:25
    #13 0x6205f12d in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13
    #14 0x6204a626 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6
    #15 0x6204fd5d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9
    #16 0x6207ae37 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #17 0xf623fed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4) (BuildId: 4b5331163fe94a3dfbf1df5969e5ef6bde73d461)
    #18 0x62043984 in _start (/out/pcre2_fuzzer_32_3l+0x5a984)

DEDUP_TOKEN: __sanitizer_print_stack_trace--fuzzer::PrintStackTrace()--fuzzer::Fuzzer::AlarmCallback()
SUMMARY: libFuzzer: timeout
INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /mnt/sdb/oss-fuzz/oss-fuzz/build/out/pcre2:/out -v /mnt/sdb/oss-fuzz/oss-fuzz/build/out/pcre2/testcase/testcase_42538063:/testcase -t gcr.io/oss-fuzz-base/base-runner reproduce pcre2_fuzzer_32_3l -runs=100.

==================================================
PoC Triggered: YES
